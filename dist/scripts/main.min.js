"use strict";function getClosestTime(e,t){for(var n=t[0],i=1;i<t.length;i++){if(e>n&&(n=t[i]),t[i]===e)return void(n=e);t[i]>e&&t[i]<n&&(n=t[i])}return n}function getTimeTillNext(e,t){var n=moment(e,"HH:mm:ss"),i=moment(t,"HH:mm:ss"),o=moment(i.diff(n)).format("mm:ss");return o}function getNextSubwayTime(){getSubwaySchedule(SUBWAY_ID).then(function(e){var t=e.data.result.arrivals,n=moment(),i=n.format("HH:mm:ss"),o=getClosestTime(i,t),a=getTimeTillNext(i,o);renderNext(a)})["catch"](function(e){renderError(e)})}function getSubwaySchedule(e){return axios.get("http://mtaapi.herokuapp.com/api?id="+e)}function renderNext(e){times_first.innerHTML=formatTextResponse(e)+"min",console.log("The next subway is in "+e)}function renderError(e){console.error(data)}function formatTextResponse(e){return e=e.split(":"),e=e[0],"0"==e[0]&&(e=e[1]),e}function triggerAnimations(){var e=document.querySelectorAll(".app-content_item");resetAnimations(),setTimeout(function(){for(var t=0;t<e.length;t++)e[t].className="app-content_item animate"},1)}function resetAnimations(){for(var e=document.querySelectorAll(".app-content_item"),t=0;t<e.length;t++)console.log(t),e[t].className="app-content_item"}function bindClickEvents(){app_container.onclick=function(){"sleep"==app_state&&triggerAnimations(),resetSleepTimer()}}function resetSleepTimer(){console.log("timeout cleared"),setSleepState(!1),clearTimeout(app_timeout),sleepTimer()}function sleepTimer(){app_timeout=setTimeout(function(){setSleepState(!0)},SLEEP_TIMER)}function goToSleep(){clearTimeout(app_timeout),setSleepState(!0),resetAnimations()}function setSleepState(e){e?(app_container.className="sleep",app_state="sleep",resetAnimations()):(app_container.className="",app_state="active")}function loop(){getNextSubwayTime(),setInterval(getNextSubwayTime,REFRESH_TIMER)}var SUBWAY_ID="G26N",REFRESH_TIMER=1e4,SLEEP_TIMER=3e4,times_first=document.getElementById("subway-times_first"),times_second=document.getElementById("subway-times_second"),app_container=document.getElementById("app-container"),app_timeout=void 0,app_state="sleep";bindClickEvents(),sleepTimer(),loop();